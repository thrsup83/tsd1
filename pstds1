$ScriptExtension = $GpoXml.Rsop.ComputerResults.ExtensionData | Where-Object { $_.Name -eq "Scripts" }
$StartupScripts = $ScriptExtension.Extension.Script | Where-Object { $_.Type -eq "Startup" }

Write-Host "`n--- Startup Scripts Analysis ---" -ForegroundColor Yellow

if ($StartupScripts) {
    foreach ($Script in $StartupScripts) {
        $SourceGPO = $Script.SourceGPO.Name
        $Cmd = $Script.Command
        $Params = $Script.Parameters
        
        Write-Host "Found Startup Script in GPO: " -NoNewline
        Write-Host "$SourceGPO" -ForegroundColor Red
        Write-Host "   -> Command: $Cmd $Params" -ForegroundColor Cyan
    }
} else {
    Write-Host "No GPO-based Startup Scripts detected." -ForegroundColor Green
}

# Cleanup
Remove-Item $XmlPath -Force

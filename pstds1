Stop-Process -Name "notepad++" -Force -ErrorAction SilentlyContinue

Get-ItemProperty "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*", "HKLM:\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*" -ErrorAction SilentlyContinue | 
Where-Object { $_.DisplayName -like "*Notepad++*" } | 
ForEach-Object {
    $u = $_.UninstallString -replace '"', ''
    if ($u -and (Test-Path $u)) {
        Write-Output "Uninstalling: $($_.DisplayName)"
        Start-Process -FilePath $u -ArgumentList "/S" -Wait
        Write-Output "Success"
    }
}

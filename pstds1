$Processes = @("chrome", "googleupdate", "GoogleUpdate.exe", "GoogleCrashHandler", "GoogleCrashHandler64")
foreach ($P in $Processes) { Stop-Process -Name $P -Force -ErrorAction SilentlyContinue }

$Services = @("gupdate", "gupdatem")
foreach ($S in $Services) { Stop-Service -Name $S -ErrorAction SilentlyContinue }

$Folders = @(
    "$env:ProgramFiles\Google\Chrome",
    "${env:ProgramFiles(x86)}\Google\Chrome",
    "$env:LOCALAPPDATA\Google\Chrome",
    "$env:ProgramData\Google\Chrome"
)
foreach ($F in $Folders) { if (Test-Path $F) { Remove-Item -Path $F -Recurse -Force -ErrorAction SilentlyContinue } }

$RegKeys = @(
    "HKLM:\SOFTWARE\Google\Chrome",
    "HKLM:\SOFTWARE\Wow6432Node\Google\Chrome",
    "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\Google Chrome",
    "HKCU:\Software\Google\Chrome",
    "HKCU:\Software\Google\Update\Clients",
    "HKLM:\SOFTWARE\Wow6432Node\Google\Update\Clients"
)
foreach ($K in $RegKeys) { if (Test-Path $K) { Remove-Item -Path $K -Recurse -Force -ErrorAction SilentlyContinue } }

Get-ScheduledTask -TaskName "GoogleUpdate*" -ErrorAction SilentlyContinue | Unregister-ScheduledTask -Confirm:$false -ErrorAction SilentlyContinue

Write-Host "Cleanup completed." -ForegroundColor Green

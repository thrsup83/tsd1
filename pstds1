# Define os caminhos de busca no registro (64 e 32 bits)
$Paths = @(
    "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*",
    "HKLM:\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*"
)

# Busca qualquer entrada que contenha "Notepad++"
$Apps = Get-ItemProperty $Paths -ErrorAction SilentlyContinue | 
        Where-Object { $_.DisplayName -like "*Notepad++*" } | 
        Select-Object DisplayName, DisplayVersion

if ($Apps) {
    foreach ($App in $Apps) {
        Write-Output "STATUS: INSTALADO | Nome: $($App.DisplayName) | Versao: $($App.DisplayVersion)"
    }
} else {
    Write-Output "STATUS: NAO ENCONTRADO"
}

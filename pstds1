$path = "C:\Program Files\Google\Chrome\Application\chrome.exe"
if (-not (Test-Path $path)) {
    $path = "C:\Program Files (x86)\Google\Chrome\Application\chrome.exe"
}

if (Test-Path $path) {
    $bytes = [System.IO.File]::ReadAllBytes($path)
    $offset = [System.BitConverter]::ToUInt32($bytes, 0x3c)
    $machine = [System.BitConverter]::ToUInt16($bytes, $offset + 4)
    if ($machine -eq 0x8664) { "64" } else { "32" }
}


$vsta = "C:\Program Files\Common Files\Microsoft Shared\VSTA\16.0\Bin\VstaCore.dll"
(Get-Item $vsta).VersionInfo | Format-List FileVersion,ProductVersion,ProductName


$vswhere = "${env:ProgramFiles(x86)}\Microsoft Visual Studio\Installer\vswhere.exe"
if (Test-Path $vswhere) {
  & $vswhere -products * -all -format table
} else {
  "vswhere NAO encontrado em: $vswhere"
}


Get-ItemProperty HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\*, `
                 HKLM:\Software\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall\* |
  Where-Object { $_.DisplayName -match 'VSTA|Tools for Applications|Visual Studio|Build Tools' } |
  Select-Object DisplayName, DisplayVersion, Publisher |
  Sort-Object DisplayName
